version: "2"

volumes:
  node_data:
  client_data:

services:
  tshark:
    image: t3z0s/test:latest
    hostname: tshark
    command: /home/appuser/tests/tshark_with_ocaml_node/bin/listen-to-tezos-node.sh
    tmpfs:
      - /tmp
    volumes:
      - node_data:/var/run/tezos/node
      - client_data:/var/run/tezos/client
    restart: on-failure
  tezos_node:
    image: t3z0s/tezos:v7.3
    depends_on:
      - tshark
    hostname: node
    entrypoint: /usr/local/T3z0s/tests/tshark_with_ocaml_node/bin/start-tezos-node.sh
    ports:
      - "19732:19732"
    expose:
      - "8732"
    tmpfs:
      - /tmp
    volumes:
      - node_data:/var/run/tezos/node
      - client_data:/var/run/tezos/client
    restart: on-failure